<!doctype html>
<html itemscope itemtype="http://schema.org/WebPage" lang="cn" class="no-js">
  <head>
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="generator" content="Hugo 0.115.2">
<link rel="canonical" type="text/html" href="https://bwangelme.github.io/647/docs/linux/">
<link rel="alternate" type="application/rss&#43;xml" href="https://bwangelme.github.io/647/docs/linux/index.xml">
<meta name="robots" content="noindex, nofollow">


<link rel="shortcut icon" href="/647/favicons/favicon.ico" >
<link rel="apple-touch-icon" href="/647/favicons/apple-touch-icon-180x180.png" sizes="180x180">
<link rel="icon" type="image/png" href="/647/favicons/favicon-16x16.png" sizes="16x16">
<link rel="icon" type="image/png" href="/647/favicons/favicon-32x32.png" sizes="32x32">
<link rel="icon" type="image/png" href="/647/favicons/android-36x36.png" sizes="36x36">
<link rel="icon" type="image/png" href="/647/favicons/android-48x48.png" sizes="48x48">
<link rel="icon" type="image/png" href="/647/favicons/android-72x72.png" sizes="72x72">
<link rel="icon" type="image/png" href="/647/favicons/android-96x96.png" sizes="96x96">
<link rel="icon" type="image/png" href="/647/favicons/android-144x144.png" sizes="144x144">
<link rel="icon" type="image/png" href="/647/favicons/android-192x192.png" sizes="192x192">

<title>Linux | 647 Universe</title>
<meta name="description" content="宇宙很大，生活更大，也许以后还有缘相见">
<meta property="og:title" content="Linux" />
<meta property="og:description" content="宇宙很大，生活更大，也许以后还有缘相见" />
<meta property="og:type" content="website" />
<meta property="og:url" content="https://bwangelme.github.io/647/docs/linux/" /><meta property="og:site_name" content="647号宇宙" />
<meta itemprop="name" content="Linux">
<meta itemprop="description" content="宇宙很大，生活更大，也许以后还有缘相见"><meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Linux"/>
<meta name="twitter:description" content="宇宙很大，生活更大，也许以后还有缘相见"/>




<link rel="preload" href="/647/scss/main.min.291c723daa8f2fb6b09f56ac9a2ca71406607a4268e1fe586dddad1a8583b4e7.css" as="style">
<link href="/647/scss/main.min.291c723daa8f2fb6b09f56ac9a2ca71406607a4268e1fe586dddad1a8583b4e7.css" rel="stylesheet" integrity="">

<script
  src="https://code.jquery.com/jquery-3.6.3.min.js"
  integrity="sha512-STof4xm1wgkfm7heWqFJVn58Hm3EtS31XFaagaa8VMReCXAkQnJZ+jEy8PCC/iT18dFy95WcExNHFTqLyp72eQ=="
  crossorigin="anonymous"></script>
<link rel="stylesheet" href="/647/css/prism.css"/>

  </head>
  <body class="td-section">
    <header>
      <nav class="td-navbar navbar-dark js-navbar-scroll">
<div class="container-fluid flex-column flex-md-row">
  <a class="navbar-brand" href="/647/"><span class="navbar-brand__logo navbar-logo"><svg id="Layer_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" viewBox="0 0 500 500" style="enable-background:new 0 0 500 500"><g><path style="fill:#fff" d="M116.8525 421.9722c-5.7041.0-10.3442-4.3127-10.3442-9.6129V88.183c0-5.3002 4.6401-9.6117 10.3442-9.6117H320.858c3.0347.0 9.3959.5498 11.7506 2.6302l.3545.3442 58.905 63.2912c2.3101 2.491 2.9202 8.4928 2.9202 11.3184v256.2039c0 5.3002-4.6407 9.6129-10.3436 9.6129H116.8525z"/><g><g><g><path style="fill:#767676" d="M384.4445 423.2066H116.852c-6.3839.0-11.5786-4.8658-11.5786-10.8474V88.1831c0-5.9804 5.1947-10.8461 11.5786-10.8461h204.0062c.377.0 9.2786.0329 12.568 2.9389l.3947.3833 58.9508 63.337c3.2135 3.4652 3.2514 11.7924 3.2514 12.1593v256.2036C396.0231 418.3408 390.8284 423.2066 384.4445 423.2066zM116.5079 411.9189c.0848.0278.1999.0531.3441.0531h267.5925c.1442.0.2581-.0253.3441-.0531V156.1556c-.0076-.9033-.3593-3.7347-.7034-5.0037l-57.6527-61.9416c-1.4651-.3176-4.4533-.6389-5.5742-.6389H116.852c-.143.0-.2594.024-.3441.0531V411.9189zm267.4533-261.149zM327.0321 89.371v.0013V89.371z"/></g></g></g><g><g><path style="fill:#5b7fc0" d="M189.0874 210.1754l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4473C177.5953 212.627 183.0601 210.1742 189.0874 210.1754zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 234.1722 197.0804 232.033z"/><path style="opacity:.3;fill:#fff" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/><g><defs><path id="SVGID_1_" d="M194.7376 237.6875c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 234.2399 196.1861 236.239 194.7376 237.6875z"/></defs><clipPath id="SVGID_2_"><use xlink:href="#SVGID_1_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_2_);fill:#fff" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/><path style="opacity:.13;clip-path:url(#SVGID_2_);fill:#020202" d="M190.0704 225.0237c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 225.7247 191.9774 225.0237 190.0704 225.0237z"/></g><g><defs><path id="SVGID_3_" d="M189.0898 210.176c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 212.6276 183.0612 210.176 189.0898 210.176zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 236.239 197.0839 234.2399 197.0839 232.0372z"/></defs><clipPath id="SVGID_4_"><use xlink:href="#SVGID_3_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_4_);fill:#5b7fc0" d="M172.6595 215.6045c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8475-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 209.1953 176.6171 211.647 172.6595 215.6045z"/></g></g><rect x="198.8952" y="225.1043" style="fill:#5b7fc0" width="122.6266" height="13.8671"/></g><g><path style="fill:#d95140" d="M189.0874 155.7611l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.0249 2.454-11.4897 6.4116-15.4473C177.5953 158.2128 183.0601 155.7599 189.0874 155.7611zm7.993 21.8577c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.2508 181.7667 197.0816 179.758 197.0804 177.6188z"/><path style="opacity:.3;fill:#fff" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/><g><defs><path id="SVGID_5_" d="M194.7376 183.2733c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 179.8256 196.1861 181.8248 194.7376 183.2733z"/></defs><clipPath id="SVGID_6_"><use xlink:href="#SVGID_5_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_6_);fill:#fff" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/><path style="opacity:.13;clip-path:url(#SVGID_6_);fill:#020202" d="M190.0704 170.6095c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9546.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.663-2.8588-6.116.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C193.7885 171.3104 191.9774 170.6095 190.0704 170.6095z"/></g><g><defs><path id="SVGID_7_" d="M189.0898 155.7617c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8066-21.8612-21.8613.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 158.2134 183.0612 155.7617 189.0898 155.7617zm7.9941 21.8613c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 181.8248 197.0839 179.8256 197.0839 177.623z"/></defs><clipPath id="SVGID_8_"><use xlink:href="#SVGID_7_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_8_);fill:#d95140" d="M172.6595 161.1903c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 154.7811 176.6171 157.2327 172.6595 161.1903z"/></g><rect x="198.8952" y="170.69" style="fill:#d95140" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#56a55c" d="M189.5379 264.6147l.0012-.0012c7.7751.0012 15.0294 4.1862 18.932 10.9235 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3304-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032-5.8394.0-11.3281-2.2733-15.458-6.4032-4.13-4.13-6.4032-9.6186-6.4056-15.4628.0012-6.0249 2.454-11.4897 6.4116-15.4472C178.0458 267.0663 183.5105 264.6135 189.5379 264.6147zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6538 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403C196.7013 290.6202 197.5321 288.6115 197.5309 286.4723z"/><path style="opacity:.3;fill:#fff" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/><g><defs><path id="SVGID_9_" d="M195.1881 292.1268c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.9989 7.9942-7.9941 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.5344 288.6792 196.6366 290.6783 195.1881 292.1268z"/></defs><clipPath id="SVGID_10_"><use xlink:href="#SVGID_9_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_10_);fill:#fff" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/><path style="opacity:.13;clip-path:url(#SVGID_10_);fill:#020202" d="M190.5209 279.463c-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7446-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9941 2.3802-1e-4 4.616 1.0833 6.1218 2.8788C194.239 280.164 192.4279 279.463 190.5209 279.463z"/></g><g><defs><path id="SVGID_11_" d="M189.5403 264.6153c7.7763.0 15.0283 4.1826 18.926 10.9151 1.9201 3.3135 2.9377 7.0987 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8613-12.0547.0024-21.8636-9.8065-21.8612-21.8613.0-6.0285 2.4516-11.492 6.4116-15.452C178.0482 267.0669 183.5117 264.6153 189.5403 264.6153zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9941.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.6366 290.6783 197.5344 288.6792 197.5344 286.4765z"/></defs><clipPath id="SVGID_12_"><use xlink:href="#SVGID_11_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_12_);fill:#56a55c" d="M173.11 270.0439c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8613 12.0547.0024 21.8636-9.797 21.8613-21.8613.0024-3.8474-1.0151-7.6326-2.9353-10.9462-3.8977-6.7325-11.1497-10.9151-18.926-10.9151C182.5311 263.6346 177.0676 266.0863 173.11 270.0439z"/></g></g><rect x="199.3456" y="279.5436" style="fill:#56a55c" width="122.6266" height="13.8671"/></g><g><g><path style="fill:#f1bc42" d="M189.0874 318.7208l.0012-.0012c7.7751.0012 15.0295 4.1862 18.932 10.9234 1.9177 3.3159 2.9305 7.1011 2.9293 10.9378.0 5.8394-2.2733 11.3305-6.4032 15.4604-4.1288 4.1288-9.6186 6.4032-15.458 6.4032s-11.328-2.2733-15.458-6.4032-6.4032-9.6186-6.4056-15.4628c.0012-6.025 2.454-11.4897 6.4116-15.4472C177.5953 321.1724 183.0601 318.7196 189.0874 318.7208zm7.993 21.8576c.0012-1.4042-.3687-2.7868-1.063-3.9887-1.4293-2.4684-4.0833-3.9995-6.9299-4.0019-4.4077.0024-7.993 3.5877-7.993 7.993.0 2.1356.832 4.1431 2.3427 5.6539 1.5083 1.5083 3.5159 2.3403 5.6503 2.3415 2.1356.0 4.1443-.8308 5.6539-2.3403S197.0816 342.7176 197.0804 340.5784z"/><path style="opacity:.3;fill:#fff" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/><g><defs><path id="SVGID_13_" d="M194.7376 346.2329c-1.4461 1.4461-3.4452 2.3439-5.6479 2.3439-4.4077-.0024-7.9918-3.5865-7.9942-7.9942.0024-4.4125 3.5937-7.999 7.9942-7.9942 2.8443.0 5.497 1.5323 6.924 3.9983.6991 1.2067 1.0702 2.5881 1.0702 3.9959C197.0839 342.7853 196.1861 344.7844 194.7376 346.2329z"/></defs><clipPath id="SVGID_14_"><use xlink:href="#SVGID_13_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_14_);fill:#fff" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/><path style="opacity:.13;clip-path:url(#SVGID_14_);fill:#020202" d="M190.0704 333.5691c-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0011 1.9547.7088 3.7452 1.8782 5.1354-1.7447-1.4674-2.8575-3.6631-2.8588-6.1161.0024-4.4125 3.5936-7.999 7.9942-7.9942 2.3802-1e-4 4.616 1.0834 6.1218 2.8788C193.7885 334.2701 191.9774 333.5691 190.0704 333.5691z"/></g><g><defs><path id="SVGID_15_" d="M189.0898 318.7214c7.7763.0 15.0283 4.1826 18.926 10.915 1.9201 3.3136 2.9377 7.0988 2.9353 10.9462.0024 12.0643-9.8065 21.8636-21.8613 21.8612-12.0547.0024-21.8636-9.8065-21.8612-21.8612.0-6.0285 2.4516-11.4921 6.4116-15.452C177.5977 321.173 183.0612 318.7214 189.0898 318.7214zm7.9941 21.8612c0-1.4078-.3711-2.7892-1.0702-3.9959-1.4269-2.466-4.0797-3.9983-6.924-3.9983-4.4005-.0048-7.9918 3.5817-7.9942 7.9942.0024 4.4077 3.5865 7.9918 7.9942 7.9942 2.2027.0 4.2018-.8978 5.6479-2.3439C196.1861 344.7844 197.0839 342.7853 197.0839 340.5826z"/></defs><clipPath id="SVGID_16_"><use xlink:href="#SVGID_15_" style="overflow:visible"/></clipPath><path style="clip-path:url(#SVGID_16_);fill:#f1bc42" d="M172.6595 324.15c-3.96 3.96-6.4116 9.4235-6.4116 15.452-.0024 12.0547 9.8066 21.8636 21.8613 21.8612 12.0547.0024 21.8636-9.797 21.8613-21.8612.0024-3.8474-1.0151-7.6327-2.9353-10.9462-3.8977-6.7324-11.1497-10.9151-18.926-10.9151C182.0806 317.7407 176.6171 320.1924 172.6595 324.15z"/></g></g><rect x="198.8952" y="333.6497" style="fill:#f1bc42" width="122.6266" height="13.8671"/></g></g></svg></span><span class="navbar-brand__name">647 Universe</span></a>
  <div class="td-navbar-nav-scroll ms-md-auto" id="main_navbar">
    <ul class="navbar-nav">
      <li class="nav-item">
        <a class="nav-link active" href="/647/docs/"><span>Docs</span></a>
      </li>
      </ul>
  </div>
  <div class="d-none d-lg-block">
    
  </div>
</div>
</nav>
    </header>
    <div class="container-fluid td-outer">
      <div class="td-main">
        <div class="row flex-xl-nowrap">
          <main class="col-12 col-md-9 col-xl-8 ps-md-5" role="main">
            




<div class="td-content">
<div class="pageinfo pageinfo-primary d-print-none">
<p>

<a href="#" onclick="print();return false;"></a>.
</p><p>
<a href="/647/docs/linux/"></a>.
</p>
</div>



<h1 class="title">Linux</h1>





    <ul>
    
  
  
  
  

  
    
    
	
<li>1: <a href="#pg-1c2b211e34ea807b66d53c40bac236f2">curl</a></li>


    
  
    
    
	
<li>2: <a href="#pg-a5f545a950366d730141f62b977f5c24">lsof</a></li>


    
  
    
    
	
<li>3: <a href="#pg-69dc1da95bd41a25bf26e181c6ed42e5">DNS</a></li>


    
  
    
    
	
<li>4: <a href="#pg-634110a9992b6264c18b7b4beda6f789">在 Ubuntu 22.04 上搭建 NFS Server</a></li>


    
  
    
    
	
<li>5: <a href="#pg-dd6083187c74288b0bc340d1a5d75a6f">ls Tips</a></li>


    
  
    
    
	
<li>6: <a href="#pg-d666840fe7c4f359e7566250aad67c80">查看信号的快捷键</a></li>


    
  
    
    
	
<li>7: <a href="#pg-50e13d0c712358d46277160b2eed624c">Glob 语法解析</a></li>


    
  

    </ul>


<div class="content">
      
</div>
</div>


  
  
  
  

  
  

  
    
    
	
    

<div class="td-content" style="">
    
	<h1 id="pg-1c2b211e34ea807b66d53c40bac236f2">1 - curl</h1>
    
	<h2 id="curl-post-json-数据">curl POST JSON 数据</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>curl -X PUT -H <span style="color:#4e9a06">&#34;Content-Type: application/json&#34;</span> -d <span style="color:#4e9a06">&#39;@/tmp/demo.json&#39;</span> :9200/demo
</span></span><span style="display:flex;"><span>ø&gt; cat /tmp/demo.json
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>    <span style="color:#4e9a06">&#34;settings&#34;</span>: <span style="color:#ce5c00;font-weight:bold">{</span>
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;number_of_shards&#34;</span>: 1,
</span></span><span style="display:flex;"><span>        <span style="color:#4e9a06">&#34;number_of_replicas&#34;</span>: <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>    <span style="color:#ce5c00;font-weight:bold">}</span>
</span></span><span style="display:flex;"><span><span style="color:#ce5c00;font-weight:bold">}</span>
</span></span></code></pre></div><h2 id="使用---resolve-选项替换域名">使用 <code>--resolve</code> 选项替换域名</h2>
<ul>
<li>将 <a href="https://www.google.com">www.google.com</a> 替换成 127.0.0.1，并访问 8000 端口</li>
</ul>
<p><code>curl -v --resolve www.google.com:8000:127.0.0.1 http://www.google.com:8000/ping</code></p>
<ul>
<li>将 <a href="https://www.google.com">https://www.google.com</a> 替换成 127.0.0.1，此时 curl 会忽略证书和域名不匹配的问题</li>
</ul>
<p><code>curl -v --resolve www.google.com:443:127.0.0.1 https://www.google.com/ping</code></p>
<ul>
<li>将 <a href="http://www.google.com">http://www.google.com</a> 替换成 127.0.0.1，http 默认访问 80 端口</li>
</ul>
<p><code>curl -v --resolve www.google.com:80:127.0.0.1 http://www.google.com/ping</code></p>
<h2 id="--fail-和---fail-with-body"><code>--fail</code> 和 <code>--fail-with-body</code></h2>
<p>这两个选项都可以让 curl 在接收到 400 及以上的 HTTP 响应码的时候，将退出码设置为 22</p>
<p><code>--fail-with-body</code> 会输出服务端返回的内容到 stdout 或文件中</p>
<p><code>--fail</code> 不会有任何输出，当服务端返回的是认证相关的状态码时(401/407), 可能会让使用者误以为出错了</p>
<h3 id="使用场景">使用场景</h3>
<p>在一个 dockerfile 中，我期望下载项目的 <code>go.mod</code> 和 <code>go.sum</code> 文件，然后再执行 <code>go mod download</code>。
这样可以在 clone 代码之前，先下载 go module 文件。</p>
<p>如果项目的代码变了，但是依赖并没有变，因为 docker build 的缓存原理，可以省去下载 go module 的步骤。</p>
<pre tabindex="0"><code>...
ARG app_repo
ARG app_commit

RUN [[ ! -d /tmp/app ]] &amp;&amp; mkdir /tmp/app &amp;&amp; \
    curl -s https://raw.githubusercontent.com/${app_repo}/${app_commit}/go.mod -o /tmp/app/go.mod &amp;&amp; \
    curl -s https://raw.githubusercontent.com/${app_repo}/${app_commit}/go.sum -o /tmp/app/go.sum

RUN cd /tmp/app &amp;&amp; go mod download
...
</code></pre><p>当 app_repo 和 app_commit 参数错误，导致对应的 go.mod 文件不存在，curl 会得到 404 的 HTTP 响应码，此时我期望 docker build 出错。</p>
<p>但实际上并不会出错，docker build 会继续执行，直到 go mod download 文件无法识别 go.mod 文件，docker build 才会异常退出。</p>
<p>显示的错误内容如下:</p>
<pre tabindex="0"><code>0.467 go: errors parsing go.mod:
0.467 /tmp/app/go.mod:1: unknown directive: 404:
</code></pre><p>当我给 <code>curl</code> 加上了 <code>--fail</code> 选项之后，程序就会在下载 go.mod 出错时直接退出。显示的错误如下:</p>
<pre tabindex="0"><code>ERROR: failed to solve: 
	process &#34;
		/bin/bash -c [[ ! -d /tmp/app ]] &amp;&amp; mkdir /tmp/app &amp;&amp;
		curl --fail -s https://raw.githubusercontent.com/${app_repo}/${app_commit}/go.mod -o /tmp/app/go.mod &amp;&amp;
		curl -s https://raw.githubusercontent.com/${app_repo}/${app_commit}/go.sum -o /tmp/app/go.sum
	&#34; did not complete successfully: exit code: 22
</code></pre><p>最终的 dockerfile 代码及复现命令</p>
<pre tabindex="0"><code>FROM golang:1.19
SHELL [&#34;/bin/bash&#34;, &#34;-c&#34;]

ARG app_repo
ARG app_commit

RUN go env -w GOPROXY=https://goproxy.cn,direct

RUN [[ ! -d /tmp/app ]] &amp;&amp; mkdir /tmp/app &amp;&amp; \
    curl --fail -s https://raw.githubusercontent.com/${app_repo}/${app_commit}/go.mod -o /tmp/app/go.mod &amp;&amp; \
    curl -s https://raw.githubusercontent.com/${app_repo}/${app_commit}/go.sum -o /tmp/app/go.sum

RUN cd /tmp/app &amp;&amp; go mod download
RUN HTTP_PROXY=&#39;http://改成你自己的代理&#39; HTTPS_PROXY=&#39;http://改成你自己的代理&#39; git clone https://github.com/${app_repo}.git ~/app
RUN cd ~/app &amp;&amp; git reset --hard ${app_commit} &amp;&amp; go build .
</code></pre><ul>
<li>复现命令</li>
</ul>
<pre tabindex="0"><code># 注意这个 app_commit 是一个不存在的 commit
docker build -t curl_test --build-arg app_repo=bwangelme/rdcdemo --build-arg app_commit=2f24a0658d7feb0205e7d75b7ae218ff6495e8f3 .
</code></pre>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-a5f545a950366d730141f62b977f5c24">2 - lsof</h1>
    
	<h2 id="按照网络状态筛选进程的-fd">按照网络状态筛选进程的 fd</h2>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo lsof -i -sTCP:LISTEN -a -p &lt;pid&gt;
</span></span></code></pre></div><ul>
<li>
<p><code>-a</code> 表示 and, 前后两个条件要一起生效</p>
</li>
<li>
<p><code>-i</code> 和 <code>-s</code> 一起用，表示可以按照 TCP/UDP 状态来筛选 fd</p>
</li>
<li>
<p>列出进程 <code>&lt;pid&gt;</code> 建立的所有 TCP 连接</p>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo lsof -i -sTCP:ESTABLISHED -a -p &lt;pid&gt;
</span></span></code></pre></div><ul>
<li>列出进程 <code>&lt;pid&gt;</code> 所有 IDLE 状态的 UDP 连接</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo lsof -i -sUDP:IDLE -a -p &lt;pid&gt;
</span></span></code></pre></div><p>根据 Unix 发行版本的不同，TCP/UDP 状态也会有不同的名字:</p>
<ul>
<li>常用的 TCP 状态是: <code>CLOSED</code>, <code>IDLE</code>, <code>BOUND</code>, <code>LISTEN</code>, <code>ESTABLISHED</code>, <code>SYN_SENT</code>, <code>SYN_RCDV</code>, <code>ESTABLISHED</code>, <code>CLOSE_WAIT</code>, <code>FIN_WAIT1</code>, <code>CLOSING</code>, <code>LAST_ACK</code>, <code>FIN_WAIT_2</code>, <code>TIME_WAIT</code>.</li>
<li>常用的 UDP 状态是: <code>Unbound</code>, <code>Idle</code></li>
</ul>
<h2 id="按照-fd-number-查找进程的-fd">按照 fd number 查找进程的 fd</h2>
<p>使用 <code>strace</code> 查看进程的系统调用的时候，经常能够看到在某个 fd 上执行读写操作，例如:</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>write<span style="color:#ce5c00;font-weight:bold">(</span>267, <span style="color:#4e9a06">&#34;\1\0\0\0\0\0\0\0&#34;</span>, 8<span style="color:#ce5c00;font-weight:bold">)</span>       <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">8</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>5405, <span style="color:#4e9a06">&#34;# Kubernetes-managed hosts file &#34;</span>..., 4096<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4096</span>
</span></span></code></pre></div><p>我们想要查一下这个 267 和 5405 具体代表了什么连接，可以用</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>sudo lsof -d &lt;fd_number&gt; -a -p &lt;pid&gt;
</span></span></code></pre></div><p>例如我利用 strace 查看飞书 app 的系统调用，看到以下的信息</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ø&gt; sudo strace -p <span style="color:#0000cf;font-weight:bold">8261</span>
</span></span><span style="display:flex;"><span>strace: Process <span style="color:#0000cf;font-weight:bold">8261</span> attached
</span></span><span style="display:flex;"><span>restart_syscall<span style="color:#ce5c00;font-weight:bold">(</span>&lt;... resuming interrupted <span style="color:#204a87">read</span> ...&gt;<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>openat<span style="color:#ce5c00;font-weight:bold">(</span>AT_FDCWD, <span style="color:#4e9a06">&#34;/proc/self/status&#34;</span>, O_RDONLY<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>4, <span style="color:#4e9a06">&#34;Name:\tfeishu\nUmask:\t0002\nState:\t&#34;</span>..., 1024<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1024</span>
</span></span><span style="display:flex;"><span>close<span style="color:#ce5c00;font-weight:bold">(</span>4<span style="color:#ce5c00;font-weight:bold">)</span>                                <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span>
</span></span><span style="display:flex;"><span>futex<span style="color:#ce5c00;font-weight:bold">(</span>0x7ff0a7ffead8, FUTEX_WAKE_PRIVATE, 2147483647<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>futex<span style="color:#ce5c00;font-weight:bold">(</span>0x7ff0a7ffea88, FUTEX_WAKE_PRIVATE, 1<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>recvmsg<span style="color:#ce5c00;font-weight:bold">(</span>23, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">msg_namelen</span><span style="color:#ce5c00;font-weight:bold">=</span>0<span style="color:#ce5c00;font-weight:bold">}</span>, 0<span style="color:#ce5c00;font-weight:bold">)</span>         <span style="color:#ce5c00;font-weight:bold">=</span> -1 EAGAIN <span style="color:#ce5c00;font-weight:bold">(</span>资源暂时不可用<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>recvmsg<span style="color:#ce5c00;font-weight:bold">(</span>23, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">msg_namelen</span><span style="color:#ce5c00;font-weight:bold">=</span>0<span style="color:#ce5c00;font-weight:bold">}</span>, 0<span style="color:#ce5c00;font-weight:bold">)</span>         <span style="color:#ce5c00;font-weight:bold">=</span> -1 EAGAIN <span style="color:#ce5c00;font-weight:bold">(</span>资源暂时不可用<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>poll<span style="color:#ce5c00;font-weight:bold">([{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>9, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>10, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>22, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>23, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>67, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}]</span>, 5, 0<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">0</span> <span style="color:#ce5c00;font-weight:bold">(</span>Timeout<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>recvmsg<span style="color:#ce5c00;font-weight:bold">(</span>23, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">msg_namelen</span><span style="color:#ce5c00;font-weight:bold">=</span>0<span style="color:#ce5c00;font-weight:bold">}</span>, 0<span style="color:#ce5c00;font-weight:bold">)</span>         <span style="color:#ce5c00;font-weight:bold">=</span> -1 EAGAIN <span style="color:#ce5c00;font-weight:bold">(</span>资源暂时不可用<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>recvmsg<span style="color:#ce5c00;font-weight:bold">(</span>23, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">msg_namelen</span><span style="color:#ce5c00;font-weight:bold">=</span>0<span style="color:#ce5c00;font-weight:bold">}</span>, 0<span style="color:#ce5c00;font-weight:bold">)</span>         <span style="color:#ce5c00;font-weight:bold">=</span> -1 EAGAIN <span style="color:#ce5c00;font-weight:bold">(</span>资源暂时不可用<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>poll<span style="color:#ce5c00;font-weight:bold">([{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>9, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>10, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>22, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>23, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}</span>, <span style="color:#ce5c00;font-weight:bold">{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>67, <span style="color:#000">events</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}]</span>, 5, 200<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#ce5c00;font-weight:bold">([{</span><span style="color:#000">fd</span><span style="color:#ce5c00;font-weight:bold">=</span>10, <span style="color:#000">revents</span><span style="color:#ce5c00;font-weight:bold">=</span>POLLIN<span style="color:#ce5c00;font-weight:bold">}])</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>10, <span style="color:#4e9a06">&#34;!&#34;</span>, 2<span style="color:#ce5c00;font-weight:bold">)</span>                        <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>futex<span style="color:#ce5c00;font-weight:bold">(</span>0x7ff0a7ffead8, FUTEX_WAKE_PRIVATE, 2147483647<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>futex<span style="color:#ce5c00;font-weight:bold">(</span>0x7ff0a7ffea88, FUTEX_WAKE_PRIVATE, 1<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>futex<span style="color:#ce5c00;font-weight:bold">(</span>0x7ff0a0001eb8, FUTEX_WAKE_PRIVATE, 1<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1</span>
</span></span><span style="display:flex;"><span>openat<span style="color:#ce5c00;font-weight:bold">(</span>AT_FDCWD, <span style="color:#4e9a06">&#34;/proc/self/status&#34;</span>, O_RDONLY<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">4</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>4, <span style="color:#4e9a06">&#34;Name:\tfeishu\nUmask:\t0002\nState:\t&#34;</span>..., 1024<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1024</span>
</span></span></code></pre></div><p>我想知道 fd 4 代表了什么，执行 <code>sudo lsof -d 4 -a -p 8261</code>，可以看到它是我的电脑和 <code>220.181.131.241</code> 建立的一个 https 连接。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ø&gt; sudo lsof -d <span style="color:#0000cf;font-weight:bold">4</span> -a -p <span style="color:#0000cf;font-weight:bold">8261</span>
</span></span><span style="display:flex;"><span>COMMAND  PID      USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
</span></span><span style="display:flex;"><span>feishu  <span style="color:#0000cf;font-weight:bold">8261</span> xuyundong    4u  IPv4 <span style="color:#0000cf;font-weight:bold">2613086</span>      0t0  TCP 192.168.252.88:35810-&gt;220.181.131.241:https <span style="color:#ce5c00;font-weight:bold">(</span>ESTABLISHED<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><h2 id="查看端口占用">查看端口占用</h2>
<p>有时候我们启动程序的时候，发现端口被占用了，可以用 <code>lsof -i:xxx</code> 来查看端口被哪个进程占用了，例如:</p>
<p>下面这条命令显示 3306 端口被 <code>360702</code> 和 <code>360709</code> 两个进程占用了。</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>ø&gt; sudo lsof -i:3306
</span></span><span style="display:flex;"><span>COMMAND      PID USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
</span></span><span style="display:flex;"><span>docker-pr <span style="color:#0000cf;font-weight:bold">360702</span> root    4u  IPv4 <span style="color:#0000cf;font-weight:bold">1842886</span>      0t0  TCP *:mysql <span style="color:#ce5c00;font-weight:bold">(</span>LISTEN<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span>docker-pr <span style="color:#0000cf;font-weight:bold">360709</span> root    4u  IPv6 <span style="color:#0000cf;font-weight:bold">1842889</span>      0t0  TCP *:mysql <span style="color:#ce5c00;font-weight:bold">(</span>LISTEN<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><h2 id="查看容器的网络调用">查看容器的网络调用</h2>
<h3 id="构建镜像">构建镜像</h3>
<ul>
<li>download.py</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">#!/usr/bin/env python3</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># -*- coding: utf-8 -*-&#34;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">requests</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">resp</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#000">requests</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">get</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;https://releases.ubuntu.com/22.04.2/ubuntu-22.04.2-desktop-amd64.iso?_ga=2.131295240.668169970.1684741981-917190618.1681460407&#39;</span><span style="color:#000;font-weight:bold">)</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87">print</span><span style="color:#000;font-weight:bold">(</span><span style="color:#000">resp</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">status_code</span><span style="color:#000;font-weight:bold">)</span>
</span></span></code></pre></div><ul>
<li>Dockerfile</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-dockerfile" data-lang="dockerfile"><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">FROM</span><span style="color:#4e9a06"> python:3.10</span><span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000"></span><span style="color:#204a87;font-weight:bold">RUN</span> pip install requests<span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000"></span><span style="color:#204a87;font-weight:bold">COPY</span> download.py /download.py<span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000">
</span></span></span><span style="display:flex;"><span><span style="color:#a40000"></span><span style="color:#204a87;font-weight:bold">ENTRYPOINT</span> <span style="color:#000;font-weight:bold">[</span><span style="color:#4e9a06">&#34;python&#34;</span><span style="color:#000;font-weight:bold">,</span> <span style="color:#4e9a06">&#34;/download.py&#34;</span><span style="color:#000;font-weight:bold">]</span><span style="color:#a40000">
</span></span></span></code></pre></div><p>准备上述两个文件，然后执行</p>
<pre tabindex="0"><code>docker build -t test_download .
</code></pre><p>构建我们用于调试的镜像, <code>test_download</code> 。</p>
<h3 id="启动阻塞的容器">启动阻塞的容器</h3>
<p>执行以下命令，启动一个阻塞在网络请求中的容器。</p>
<pre tabindex="0"><code>docker run --rm test_download
</code></pre><blockquote>
<p><strong>Note</strong>:</p>
<p>这个例子不太好，因为 <code>releases.ubuntu.com</code> 还比较健康，会持续地返回内容，现实中我们遇到的情况是，服务器完全不返回内容，客户端也没有设置超时时间，完全处于阻塞的状态。</p>
</blockquote>
<h3 id="查找容器的-pid">查找容器的 pid</h3>
<p>根据容器的 ID, 我们通过 <code>docker inspect &lt;id&gt;| rg -i pid</code> 可以获得容器的进程 ID</p>
<p>如果你使用的是 containerd, 可以使用 <code>crictl inspect &lt;id&gt; | rg -i pid</code></p>
<pre tabindex="0"><code>ø&gt; docker ps
CONTAINER ID   IMAGE           COMMAND                 CREATED          STATUS          PORTS     NAMES
bf5846384913   test_download   &#34;python /download.py&#34;   37 seconds ago   Up 36 seconds             friendly_wozniak
ø&gt; docker inspect bf5846384913 | rg -i pid
            &#34;Pid&#34;: 726678,
            &#34;PidMode&#34;: &#34;&#34;,
            &#34;PidsLimit&#34;: null,
</code></pre><h3 id="利用-strace-查看进程的状态">利用 strace 查看进程的状态</h3>
<p>从 strace 的输出中可以看到，进程一直在从 3 号 fd 上读取数据</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@Macmini:~# strace -p <span style="color:#0000cf;font-weight:bold">726678</span>
</span></span><span style="display:flex;"><span>strace: Process <span style="color:#0000cf;font-weight:bold">726678</span> attached
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;Z\263\351\331\315\17\330\205\222\361\21\235&#39;Kp\301w\256\365|\275K\326y\350@\305\300\325\262\fk&#34;</span>..., 13131<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">1448</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\317GKJ\324O)1\5\272\\\&#34;\24\360s\177\263\223#\376\360\35\360\226\240\214mf\374\243\222\335&#34;</span>..., 11683<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">11683</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\22c\367U@\243\377\325\255\n0\376\79J\244\v9O4\233Kq\0233\304k\6\356dy\20&#34;</span>..., 16401<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">16401</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;[\244K\30\7\30?[\210\313\364\335\t\321&gt;l\270\2\365\262\307|\376\211.\376\342%\361\34\31\246&#34;</span>..., 16401<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">16401</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\335\373\354\320:SF\244o#\244\377Ll\21\366AT\374vgYD\2418\305\340\313||\243;&#34;</span>..., 16401<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">16401</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;X \300\240\252IoZ\352W</span>$<span style="color:#4e9a06">\255\266\324\304q\306\23\226-b\212\300\271\222pI\270\33\tcn&#34;</span>..., 16401<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">16401</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\213\331\225\331b\2405\204\f\213\32\r\250;\250\326.\4l\221\230^0\272{\317\32he\262V\223&#34;</span>..., 16401<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">16401</span>
</span></span><span style="display:flex;"><span>brk<span style="color:#ce5c00;font-weight:bold">(</span>0x55fba8f48000<span style="color:#ce5c00;font-weight:bold">)</span>                     <span style="color:#ce5c00;font-weight:bold">=</span> 0x55fba8f48000
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\4\317\362`-R}\360\&#34;\266nZ\33\261s,\340\345\371\300;]\347\30\237\344\305\235m\360j\357&#34;</span>..., 16401<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">16401</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;1v\355\312]nG\347\240\4\210\350\241\34\257\333\307\233z\261\0\6\307\2234n\21V\27\305\272\371&#34;</span>..., 16401<span style="color:#ce5c00;font-weight:bold">)</span> <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">16401</span>
</span></span><span style="display:flex;"><span>read<span style="color:#ce5c00;font-weight:bold">(</span>3, <span style="color:#4e9a06">&#34;\27\3\3@\21&#34;</span>, 5<span style="color:#ce5c00;font-weight:bold">)</span>               <span style="color:#ce5c00;font-weight:bold">=</span> <span style="color:#0000cf;font-weight:bold">5</span>
</span></span></code></pre></div><h3 id="利用-lsof-查看-fd-详细信息">利用 lsof 查看 fd 详细信息</h3>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>nsenter -n -t <span style="color:#0000cf;font-weight:bold">726678</span> lsof -d <span style="color:#0000cf;font-weight:bold">3</span> -a -p <span style="color:#0000cf;font-weight:bold">726678</span>
</span></span></code></pre></div><div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@Macmini:~# nsenter -n -t <span style="color:#0000cf;font-weight:bold">726678</span> lsof -d <span style="color:#0000cf;font-weight:bold">3</span> -a -p <span style="color:#0000cf;font-weight:bold">726678</span>
</span></span><span style="display:flex;"><span>COMMAND    PID USER   FD   TYPE  DEVICE SIZE/OFF NODE NAME
</span></span><span style="display:flex;"><span>python  <span style="color:#0000cf;font-weight:bold">726678</span> root    3u  IPv4 <span style="color:#0000cf;font-weight:bold">9813984</span>      0t0  TCP 172.17.0.2:55378-&gt;https-services.aerodent.canonical.com:https <span style="color:#ce5c00;font-weight:bold">(</span>ESTABLISHED<span style="color:#ce5c00;font-weight:bold">)</span>
</span></span></code></pre></div><p>可以看到，3号fd 是一个TCP 连接，本地的 <code>172.17.0.2:55378</code> 连接了远端的 <code>https-services.aerodent.canonical.com:https</code></p>
<blockquote>
<p><strong>Note</strong></p>
<p>如果我们不加 nsenter -n -t <pid> 来切换 network namespace 的话，lsof 输出的信息中就没有详细的客户端和服务端的地址了</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span>root@Macmini:~# lsof -d <span style="color:#0000cf;font-weight:bold">3</span> -a -p <span style="color:#0000cf;font-weight:bold">729160</span>
</span></span><span style="display:flex;"><span>COMMAND    PID USER   FD   TYPE DEVICE SIZE/OFF    NODE NAME
</span></span><span style="display:flex;"><span>python  <span style="color:#0000cf;font-weight:bold">729160</span> root    3u  sock    0,8      0t0 <span style="color:#0000cf;font-weight:bold">9829458</span> protocol: TCP
</span></span></code></pre></div><h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://linux.die.net/man/8/lsof">man lsof</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-69dc1da95bd41a25bf26e181c6ed42e5">3 - DNS</h1>
    
	<h2 id="a-记录">A 记录</h2>
<p>Address Mapping records, 指示了对应名称的IPv4地址, A记录用来将域名转换为ip地址.</p>
<h2 id="aaaa-记录">AAAA 记录</h2>
<p>类似于A记录, 只不过指示的是IPv6的地址。</p>
<p>因为 IPv6 地址长度是 IPv4 的四倍，所以用 AAAA 表示 IPv6 记录</p>
<h2 id="ns-记录">NS 记录</h2>
<ul>
<li>Name Server records, 用来指定对应名称的可信名称服务器 (authoritative name server)</li>
</ul>
<p>例如这段 dig 日志是 <code>j.gtld-servers.net</code> 告诉我们，它不知道 <code>www.baidu.com</code> 的 IP, 但是它告诉我们要查询 <code>baidu.com.</code> 域的地址，可以去 ns[12345].baidu.com 这5个地址中查。</p>
<pre tabindex="0"><code>baidu.com.              172800  IN      NS      ns2.baidu.com.
baidu.com.              172800  IN      NS      ns3.baidu.com.
baidu.com.              172800  IN      NS      ns4.baidu.com.
baidu.com.              172800  IN      NS      ns1.baidu.com.
baidu.com.              172800  IN      NS      ns7.baidu.com.
;; Received 849 bytes from 192.48.79.30#53(j.gtld-servers.net) in 316 ms
</code></pre><h2 id="ptr-记录">PTR 记录</h2>
<p>Pointer records, 通过 IP 反查域名，大部分域名服务器都不支持，目前只找到了 <code>dns.google.</code> 支持 PTR 查询</p>
<pre tabindex="0"><code>ø&gt; dig -x 8.8.4.4

;; QUESTION SECTION:
;4.4.8.8.in-addr.arpa.          IN      PTR

;; ANSWER SECTION:
4.4.8.8.in-addr.arpa.   1       IN      PTR     dns.google.
</code></pre><h2 id="cname-记录">CNAME 记录</h2>
<p>又称 alias 别名，是 A 记录的别名</p>
<p>例如以下的查询说明</p>
<ol>
<li><code>www.baidu.com.</code> 是 <code>www.a.shifen.com.</code> 的别名</li>
<li><code>www.a.shifen.com.</code> 指向了 <code>220.181.38.150</code> 和 <code>220.181.38.149</code></li>
</ol>
<pre tabindex="0"><code>ø&gt; dig -4 www.baidu.com

;; QUESTION SECTION:
;www.baidu.com.                 IN      A

;; ANSWER SECTION:
www.baidu.com.          70      IN      CNAME   www.a.shifen.com.
www.a.shifen.com.       53      IN      A       220.181.38.150
www.a.shifen.com.       53      IN      A       220.181.38.149
</code></pre><h2 id="查询方式">查询方式</h2>
<h3 id="递归查询">递归查询</h3>
<p>client 发送请求给局域网 DNS, 局域网 DNS 再去上游 DNS 服务器执行进一步查询。一级一级向上递归并回到局域网 DNS , 局域网 DNS 将查询的地址返回给客户端</p>
<p>dig 命令默认执行的就是递归查询</p>
<h3 id="集中查询">集中查询</h3>
<ol>
<li>client 发送请求给局域网 DNS 获得 DNS 根服务器的地址</li>
<li>client 请求根服务器获得下一级 DNS 服务器地址</li>
<li>以此往复，一级一级直到查到目标域名的 IP 地址</li>
</ol>
<p>以下用集中查询的方式查询 <a href="https://www.baidu.com">www.baidu.com</a> IP 地址的过程</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ø&gt; dig -4 +trace www.baidu.com
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 获取根服务器的名字列表</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">;</span> &lt;&lt;&gt;&gt; DiG 9.18.12-0ubuntu0.22.04.2-Ubuntu &lt;&lt;&gt;&gt; -4 +trace www.baidu.com
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">;;</span> global options: +cmd
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      k.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      b.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      h.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      i.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      l.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      c.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      a.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      d.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      e.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      m.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      f.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      g.root-servers.net.
</span></span><span style="display:flex;"><span>.                       <span style="color:#0000cf;font-weight:bold">2229</span>    IN      NS      j.root-servers.net.
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">;;</span> Received <span style="color:#0000cf;font-weight:bold">239</span> bytes from 10.8.0.1#53<span style="color:#ce5c00;font-weight:bold">(</span>10.8.0.1<span style="color:#ce5c00;font-weight:bold">)</span> in <span style="color:#0000cf;font-weight:bold">4</span> ms
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 根服务器返回通用定义域名的名字列表</span>
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      a.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      b.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      c.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      d.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      e.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      f.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      g.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      h.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      i.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      j.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      k.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      l.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      m.gtld-servers.net.
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">86400</span>   IN      DS      <span style="color:#0000cf;font-weight:bold">30909</span> <span style="color:#0000cf;font-weight:bold">8</span> <span style="color:#0000cf;font-weight:bold">2</span> E2D3C916F6DEEAC73294E8268FB5885044A833FC5459588F4A9184CF C41A5766
</span></span><span style="display:flex;"><span>com.                    <span style="color:#0000cf;font-weight:bold">86400</span>   IN      RRSIG   DS <span style="color:#0000cf;font-weight:bold">8</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#0000cf;font-weight:bold">86400</span> <span style="color:#0000cf;font-weight:bold">20230921210000</span> <span style="color:#0000cf;font-weight:bold">20230908200000</span> <span style="color:#0000cf;font-weight:bold">11019</span> . M02FKEukwDc7T/KjNtpdCfwvkzHx1STqPt3AO/eXQxqBU7jN9vrHbJMJ PNXpBlO5p+HgnZ9w0c7sR8qnDXFl1OziNAo0el1fRq0YFwBae9BgoLCg IeZVoZmqerXpVXCrpKX1Fb+ILjuIX1bL5li2xQ/gpq4u91EijGvZg6sQ UmBiQW0JlXKR927uOm+aJHN6Ujnzd7sZrOWpSXQAOVPf4dHjvCJNohfs V9cJkjBRI+QuOpArJ+gCGKoiMidjYZBuYXIsYV7PYLQbVfVZg2E3JFXX h5BkqZUlCZbabAcVCzQ6BGZMpxcs1A/J8g/7+eguU6bJFpbiBXeHEZhx <span style="color:#000">TS1zoQ</span><span style="color:#ce5c00;font-weight:bold">==</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">;;</span> Received <span style="color:#0000cf;font-weight:bold">1173</span> bytes from 192.58.128.30#53<span style="color:#ce5c00;font-weight:bold">(</span>j.root-servers.net<span style="color:#ce5c00;font-weight:bold">)</span> in <span style="color:#0000cf;font-weight:bold">8</span> ms
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 通用顶级域名返回 baidu.com. 域的 DNS 服务器名字列表</span>
</span></span><span style="display:flex;"><span>baidu.com.              <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      ns2.baidu.com.
</span></span><span style="display:flex;"><span>baidu.com.              <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      ns3.baidu.com.
</span></span><span style="display:flex;"><span>baidu.com.              <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      ns4.baidu.com.
</span></span><span style="display:flex;"><span>baidu.com.              <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      ns1.baidu.com.
</span></span><span style="display:flex;"><span>baidu.com.              <span style="color:#0000cf;font-weight:bold">172800</span>  IN      NS      ns7.baidu.com.
</span></span><span style="display:flex;"><span>CK0POJMG874LJREF7EFN8430QVIT8BSM.com. <span style="color:#0000cf;font-weight:bold">86400</span> IN NSEC3 <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#0000cf;font-weight:bold">0</span> - CK0Q2D6NI4I7EQH8NA30NS61O48UL8G5 NS SOA RRSIG DNSKEY NSEC3PARAM
</span></span><span style="display:flex;"><span>CK0POJMG874LJREF7EFN8430QVIT8BSM.com. <span style="color:#0000cf;font-weight:bold">86400</span> IN RRSIG NSEC3 <span style="color:#0000cf;font-weight:bold">8</span> <span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#0000cf;font-weight:bold">86400</span> <span style="color:#0000cf;font-weight:bold">20230915042421</span> <span style="color:#0000cf;font-weight:bold">20230908031421</span> <span style="color:#0000cf;font-weight:bold">4459</span> com. ACWanRvoDIwYH40J5TjA8G6UXUldpz8+aNZdFlLO1eY9GRalvfLnpa6H RqiP03pvORSpHJEv2+HuQ1HtWTCj/nlJOeiRKG0Bk/HjcjkH9yv1b6pF ASeyvdJYN2wYPp4e1KPVe3GuoxBETq6kPKfUhR289IzQFy5vLgIfeVWK <span style="color:#000">pR6z0kgCFKTKaO21nj2LxxWsxmfuIpe8ztJuPTF7lVhXhw</span><span style="color:#ce5c00;font-weight:bold">==</span>
</span></span><span style="display:flex;"><span>HPVV0C47Q7CQMTAJM90K1FBFJBRP4B4D.com. <span style="color:#0000cf;font-weight:bold">86400</span> IN NSEC3 <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#0000cf;font-weight:bold">1</span> <span style="color:#0000cf;font-weight:bold">0</span> - HPVVAN8CFKHHHMEIDVJHFNQEOI5G6C89 NS DS RRSIG
</span></span><span style="display:flex;"><span>HPVV0C47Q7CQMTAJM90K1FBFJBRP4B4D.com. <span style="color:#0000cf;font-weight:bold">86400</span> IN RRSIG NSEC3 <span style="color:#0000cf;font-weight:bold">8</span> <span style="color:#0000cf;font-weight:bold">2</span> <span style="color:#0000cf;font-weight:bold">86400</span> <span style="color:#0000cf;font-weight:bold">20230914060727</span> <span style="color:#0000cf;font-weight:bold">20230907045727</span> <span style="color:#0000cf;font-weight:bold">4459</span> com. oUS/iAWQKq/0KHQdg18vwuUvT1Ftl8tnpHZVCwdQPEaIq3gceZnmpE2Z u8pj+JPFOUqp/DWRNlWZYMmTuhSjJil7cCpahWk3+RJbeJQIWPtNvBkl BBmM1M3he1ELoS37YqcflA8U/q4CaNdEpIS7OiNy6f4efrkZMvqRZZ9U hRgI2CugaGb6C9mDeAfThooAqsc5xFCX9KjWGsNLr0pE+Q<span style="color:#ce5c00;font-weight:bold">==</span>
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">;;</span> Received <span style="color:#0000cf;font-weight:bold">849</span> bytes from 192.48.79.30#53<span style="color:#ce5c00;font-weight:bold">(</span>j.gtld-servers.net<span style="color:#ce5c00;font-weight:bold">)</span> in <span style="color:#0000cf;font-weight:bold">316</span> ms
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># ns3.baidu.com 返回 www.baidu.com 的解析结果</span>
</span></span><span style="display:flex;"><span>www.baidu.com.          <span style="color:#0000cf;font-weight:bold">1200</span>    IN      CNAME   www.a.shifen.com.
</span></span><span style="display:flex;"><span><span style="color:#000;font-weight:bold">;;</span> Received <span style="color:#0000cf;font-weight:bold">100</span> bytes from 153.3.238.93#53<span style="color:#ce5c00;font-weight:bold">(</span>ns3.baidu.com<span style="color:#ce5c00;font-weight:bold">)</span> in <span style="color:#0000cf;font-weight:bold">24</span> ms
</span></span></code></pre></div><p>这是集中查询的抓包过程(建议在新 tab 中打开图片对比说明查看)</p>
<p><img src="https://passage-1253400711.cos.ap-beijing.myqcloud.com/2023-09-09-143516.png" alt=""></p>
<table>
<thead>
<tr>
<th>包序号</th>
<th>包功能</th>
</tr>
</thead>
<tbody>
<tr>
<td>1, 2</td>
<td>从 10.8.0.1 DNS 服务器获得根服务器的地址</td>
</tr>
<tr>
<td>3, 4, 5, 6, 7, 8, 9, 10, 11, 12, 13, 24, 25, 26</td>
<td>向 192.168.1.1 和 10.8.0.1 查询根服务器的地址 (两个网卡都发送了查询请求)</td>
</tr>
<tr>
<td>14, 15, 16, 17, 18, 19, 20, 21, 22, 23, 28, 29, 30, 31</td>
<td>10.8.0.1 和 192.168.1.1 返回 DNS 根服务器地址</td>
</tr>
<tr>
<td>26</td>
<td>向根服务器 <code>g.root-servers.net.</code> 查询 <code>www.baidu.com.</code> 的地址</td>
</tr>
<tr>
<td>32</td>
<td>根服务器 <code>g.root-servers.net.</code> 返回通用顶级域名列表及其地址 <code>[a-j].gtld-servers.net</code></td>
</tr>
<tr>
<td>33, 34, 35, 36, 37, 38, 39, 40, 42, 43, 44, 45</td>
<td>向 10.8.0.1 查询通用顶级域名的 IP</td>
</tr>
<tr>
<td>47, 48, 49, 50, 51, 52, 53, 54, 55, 56, 57, 58, 59</td>
<td>10.8.0.1 返回通用顶级域名的 IP</td>
</tr>
<tr>
<td>46</td>
<td>向通用顶级域名 DNS server <code>i.gtld-servers.net</code> 查询 <a href="https://www.baidu.com">www.baidu.com</a> 的 IP</td>
</tr>
<tr>
<td>60</td>
<td><code>i.gtld-servers.net</code> DNS返回 <code>baidu.com.</code> 域的 DNS 服务器 <code>ns[12347].baidu.com</code> 的名字</td>
</tr>
<tr>
<td>61, 62, 63, 64, 65, 69</td>
<td>向 192.168.1.1 和 10.8.0.1 查询 <code>ns[12347].baidu.com</code> 的 IP</td>
</tr>
<tr>
<td>66,67,68,71,72,73</td>
<td>192.168.1.1 和 10.8.0.1 返回 <code>ns[12347].baidu.com</code> 的 IP</td>
</tr>
<tr>
<td>70</td>
<td>向 <code>ns2.baidu.com</code> 查询 <code>www.baidu.com</code> 的地址</td>
</tr>
<tr>
<td>74</td>
<td><code>ns2.baidu.com</code> 返回 <code>www.baidu.com</code> 的地址，它是 <code>www.a.shifen.com</code> 地址的别名</td>
</tr>
</tbody>
</table>
<h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://www.cnblogs.com/pannengzhi/p/6262076.html">关于DNS,你应该知道这些</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-634110a9992b6264c18b7b4beda6f789">4 - 在 Ubuntu 22.04 上搭建 NFS Server</h1>
    
	<h2 id="环境准备">环境准备</h2>
<p>我准备了两台机器</p>
<table>
<thead>
<tr>
<th>name</th>
<th>ip</th>
<th>user</th>
<th>user_id</th>
</tr>
</thead>
<tbody>
<tr>
<td>server</td>
<td>191.168.58.11</td>
<td>vagrant</td>
<td>1000</td>
</tr>
<tr>
<td>client</td>
<td>192.168.58.1</td>
<td>xuyundong</td>
<td>1000</td>
</tr>
</tbody>
</table>
<h2 id="安装组件">安装组件</h2>
<ul>
<li>服务端安装 nfs server</li>
</ul>
<pre tabindex="0"><code>sudo apt update
sudo apt install nfs-kernel-server
</code></pre><ul>
<li>客户端安装 nfs-common</li>
</ul>
<pre tabindex="0"><code>sudo apt update
sudo apt install nfs-common
</code></pre><h2 id="服务端创建目录并导出">服务端创建目录并导出</h2>
<h3 id="在服务端上创建挂载目录并设置权限">在服务端上创建挂载目录，并设置权限</h3>
<pre tabindex="0"><code>sudo mkdir -p /mnt/share
sudo chown vagrant:vagrant /mnt/share
sudo chmod 755 /mnt/share
</code></pre><h3 id="服务端上配置-nfs-export-目录">服务端上配置 nfs export 目录</h3>
<p>修改 <code>/etc/exports</code> 文件, 加入以下内容</p>
<pre tabindex="0"><code>/mnt/share       *(rw,async,no_subtree_check)
</code></pre><p>关于 export 选项的解释</p>
<ul>
<li><code>rw</code>: 客户端具有读和写的权限</li>
<li><code>sync</code>: 强制 nfs 在回复 client 之前将更改写入磁盘，这保证了 nfs server 的可靠性，但也降低了写入速度</li>
<li><code>no_subtree_check</code>: 此选项可防止子树检查，在子树检查过程中，主机必须为每个请求检查文件在导出的树中是否仍然可用。当客户端打开文件时重命名文件时，这可能会导致许多问题。<strong>通常建议禁用子树检查</strong>。</li>
<li><code>no_root_squash</code>: 当客户端以 root 权限写入文件时，nfs server 会将文件 owner 改成普通用户，当此选项开启时，nfs server 不修改 root 写入文件的 woner</li>
</ul>
<p>修改完以后执行以下命令载入配置</p>
<pre tabindex="0"><code>sudo systemctl restart nfs-kernel-server
</code></pre><h2 id="客户端挂载">客户端挂载</h2>
<p>客户端执行以下命令挂载</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-bash" data-lang="bash"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># 将服务端的 nfs 目录挂载到了客户端的 /home/xuyundong/tmp/nfs_exmaple 中</span>
</span></span><span style="display:flex;"><span>sudo mount 192.168.58.11:/mnt/share /home/xuyundong/tmp/nfs_exmaple
</span></span></code></pre></div><p>修改 <code>/etc/fstab</code> 文件，将以下内容写入可以让 client 在开机启动时自动挂载</p>
<pre tabindex="0"><code>192.168.58.11:/mnt/share   /home/xuyundong/tmp/nfs_exmaple   nfs auto,nofail,noatime,nolock,intr,tcp,actimeo=1800 0 0
</code></pre><h2 id="测试访问">测试访问</h2>
<p>在客户端的目录中，<strong>以 uid=1000 的用户执行</strong></p>
<pre tabindex="0"><code>echo &#34;abc&#34; &gt; test.txt
</code></pre><p>可以看到文件正常写入了。</p>
<p>这是因为 client 的写入的用户的 uid 是 1000, server 中目录的 owner 的 uid 也是 1000, owner 相同就能正常写入。</p>
<h2 id="取消挂载">取消挂载</h2>
<p>客户端执行以下命令可以取消挂载</p>
<pre tabindex="0"><code>sudo umount ~/tmp/nfs_exmaple
</code></pre><h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-set-up-an-nfs-mount-on-ubuntu-22-04">How To Set Up an NFS Mount on Ubuntu 22.04</a></li>
</ul>

</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-dd6083187c74288b0bc340d1a5d75a6f">5 - ls Tips</h1>
    
	<h2 id="ls-按照修改时间排序">ls 按照修改时间排序</h2>
<ul>
<li><code>-t</code> 按照修改时间排序</li>
<li><code>-r</code> 逆序排序</li>
</ul>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>xuyundong@Macmini:~/Github/blog$ ls -lt content/tips/
</span></span><span style="display:flex;"><span>-rw-rw-r-- <span style="color:#0000cf;font-weight:bold">1</span> xuyundong xuyundong  <span style="color:#0000cf;font-weight:bold">800</span> 8月  <span style="color:#0000cf;font-weight:bold">16</span> 23:13 ls-tips.md.md
</span></span><span style="display:flex;"><span>-rw-rw-r-- <span style="color:#0000cf;font-weight:bold">1</span> xuyundong xuyundong <span style="color:#0000cf;font-weight:bold">2644</span> 8月  <span style="color:#0000cf;font-weight:bold">16</span> 23:05 docker-registry.md
</span></span><span style="display:flex;"><span>-rw-rw-r-- <span style="color:#0000cf;font-weight:bold">1</span> xuyundong xuyundong <span style="color:#0000cf;font-weight:bold">1990</span> 8月  <span style="color:#0000cf;font-weight:bold">11</span> 22:01 stty.md
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>xuyundong@Macmini:~/Github/blog$ ls -lrt content/tips
</span></span><span style="display:flex;"><span>-rw-rw-r-- <span style="color:#0000cf;font-weight:bold">1</span> xuyundong xuyundong <span style="color:#0000cf;font-weight:bold">1990</span> 8月  <span style="color:#0000cf;font-weight:bold">11</span> 22:01 stty.md
</span></span><span style="display:flex;"><span>-rw-rw-r-- <span style="color:#0000cf;font-weight:bold">1</span> xuyundong xuyundong <span style="color:#0000cf;font-weight:bold">2644</span> 8月  <span style="color:#0000cf;font-weight:bold">16</span> 23:05 docker-registry.md
</span></span><span style="display:flex;"><span>-rw-rw-r-- <span style="color:#0000cf;font-weight:bold">1</span> xuyundong xuyundong  <span style="color:#0000cf;font-weight:bold">897</span> 8月  <span style="color:#0000cf;font-weight:bold">16</span> 23:11 ls-tips.md.md
</span></span></code></pre></div>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-d666840fe7c4f359e7566250aad67c80">6 - 查看信号的快捷键</h1>
    
	<hr>
<h2 id="tips">Tips</h2>
<p><code>stty</code>命令的作用是 <code>change and print terminal line settings</code>，查看或修改 Linux 终端的配置。</p>
<p>今天遇到的需求是想查一下 <code>Ctrl-C</code> 按键发送的系统信号 ( <a href="https://man7.org/linux/man-pages/man7/signal.7.html">man 7 signal</a> )，搜了一下发现 stty 是最方便的查询命令</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-sh" data-lang="sh"><span style="display:flex;"><span>ø&gt; stty -a
</span></span><span style="display:flex;"><span>speed <span style="color:#0000cf;font-weight:bold">38400</span> baud<span style="color:#000;font-weight:bold">;</span> rows 68<span style="color:#000;font-weight:bold">;</span> columns 128<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">line</span> <span style="color:#ce5c00;font-weight:bold">=</span> 0<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">####################  我们主要关心这两行的内容</span>
</span></span><span style="display:flex;"><span><span style="color:#000">intr</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^C<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">quit</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^<span style="color:#4e9a06">\;</span> <span style="color:#000">erase</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^?<span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87">kill</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^U<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">eof</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^D<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">eol</span> <span style="color:#ce5c00;font-weight:bold">=</span> &lt;undef&gt;<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">eol2</span> <span style="color:#ce5c00;font-weight:bold">=</span> &lt;undef&gt;<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">swtch</span> <span style="color:#ce5c00;font-weight:bold">=</span> &lt;undef&gt;<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">start</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^Q<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">stop</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^S<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#000">susp</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^Z<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">rprnt</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^R<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">werase</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^W<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">lnext</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^V<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">discard</span> <span style="color:#ce5c00;font-weight:bold">=</span> ^O<span style="color:#000;font-weight:bold">;</span> <span style="color:#000">min</span> <span style="color:#ce5c00;font-weight:bold">=</span> 1<span style="color:#000;font-weight:bold">;</span> <span style="color:#204a87">time</span> <span style="color:#ce5c00;font-weight:bold">=</span> 0<span style="color:#000;font-weight:bold">;</span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic">####################</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span>-parenb -parodd -cmspar cs8 -hupcl -cstopb cread -clocal -crtscts
</span></span><span style="display:flex;"><span>-ignbrk -brkint -ignpar -parmrk -inpck -istrip -inlcr -igncr icrnl -ixon -ixoff -iuclc -ixany -imaxbel -iutf8
</span></span><span style="display:flex;"><span>opost -olcuc -ocrnl onlcr -onocr -onlret -ofill -ofdel nl0 cr0 tab0 bs0 vt0 ff0
</span></span><span style="display:flex;"><span>isig icanon iexten <span style="color:#204a87">echo</span> echoe echok -echonl -noflsh -xcase -tostop -echoprt echoctl echoke -flusho -extproc
</span></span></code></pre></div><p>stty 输出的解释如下:</p>
<ul>
<li><code>^C</code> (<code>ctrl+c</code>) 发送 interrupt 信号</li>
<li><code>^\</code> (<code>ctr+\</code>) 发送 quit 信号</li>
<li><code>^?</code> 清除上一个输入的字符</li>
<li><code>^U</code> 删除当前行</li>
<li><code>^D</code> 输入 EOF 字符(结束当前输入)</li>
<li><code>^S</code> 暂停输出</li>
<li><code>^Q</code> 在暂停输出后，重新开始输出</li>
<li><code>^Z</code> 发送一个 terminal stop 信号</li>
<li><code>^W</code> 删除最近输入的一个单词</li>
</ul>
<pre tabindex="0"><code>while true;do
    date;
    sleep 1
done
</code></pre><ul>
<li>(我用上面的代码测试 <code>^S</code> 和 <code>^Q</code>, 发现不生效)</li>
</ul>
<p>stty 其他输入的含义，请参考 <a href="https://linux.die.net/man/1/stty">man 1 stty</a></p>
<h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://unix.stackexchange.com/a/362579/191858">List of terminal generated signals (eg Ctrl-C -&gt; SIGINT)</a></li>
<li><a href="https://linux.die.net/man/1/stty">man 1 stty</a></li>
</ul>
</div>



    
	
  
    
    
	
    

<div class="td-content" style="page-break-before: always">
    
	<h1 id="pg-50e13d0c712358d46277160b2eed624c">7 - Glob 语法解析</h1>
    
	<p>Glob 语法</p>
<hr>
<h2 id="tips">Tips</h2>
<table>
<thead>
<tr>
<th>通配符</th>
<th>描述</th>
<th>例子</th>
<th>匹配</th>
<th>不匹配</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>*</code></td>
<td>匹配任意数量的任何字符，包括无</td>
<td><code>Law*</code></td>
<td>Law, Laws, Lawyer</td>
<td>GrokLaw, La, aw</td>
</tr>
<tr>
<td>?</td>
<td>匹配任何 单个 字符</td>
<td>?at</td>
<td>Cat, cat, Bat, bat</td>
<td>at</td>
</tr>
<tr>
<td>[abc]</td>
<td>匹配括号中给出的一个字符</td>
<td>[CB]at</td>
<td>Cat, Bat</td>
<td>cat, bat</td>
</tr>
<tr>
<td>[a-z]</td>
<td>匹配括号中给出的范围中的一个字符</td>
<td>Letter[0-9]</td>
<td>Letter0, Letter1 … Letter9</td>
<td>Letters, Letter, Letter10</td>
</tr>
<tr>
<td>[!abc]</td>
<td>匹配括号中未给出的一个字符</td>
<td>[!C]at</td>
<td>Bat, bat, cat</td>
<td>Cat</td>
</tr>
<tr>
<td>[!a-z]</td>
<td>匹配不在括号内给定范围内的一个字符</td>
<td>Letter[!3-5]</td>
<td>Letter1…</td>
<td>Letter3 … Letter5, Letterxx</td>
</tr>
</tbody>
</table>
<ul>
<li>Gitignore</li>
</ul>
<p>git 的 .gitignore 文件可以使用 glob 模式匹配， 另外还有一些规则：</p>
<p>所有空行或者以 # 开头的行都会被 Git 忽略
匹配模式可以以 / 开头防止递归
匹配模式可以以 / 结尾指定目录
要忽略指定模式以外的文件或目录，可以在模式前加上惊叹号 ! 取反</p>
<ul>
<li>Python</li>
</ul>
<p>Python 有进行 glob 匹配的标准库， 使用也很简单：</p>
<div class="highlight"><pre tabindex="0" style="background-color:#f8f8f8;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"><code class="language-py" data-lang="py"><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># -*- coding: utf-8 -*-</span>
</span></span><span style="display:flex;"><span><span style="color:#204a87;font-weight:bold">import</span> <span style="color:#000">glob</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#8f5902;font-style:italic"># glob 只有两个函数， 功能差不多， 只不过一个返回列表， 一个返回迭代器</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">glob</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">glob</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;*.org&#39;</span><span style="color:#000;font-weight:bold">)</span>  <span style="color:#8f5902;font-style:italic"># 返回所有后缀名为 .org 的文件</span>
</span></span><span style="display:flex;"><span>
</span></span><span style="display:flex;"><span><span style="color:#000">glob</span><span style="color:#ce5c00;font-weight:bold">.</span><span style="color:#000">iglob</span><span style="color:#000;font-weight:bold">(</span><span style="color:#4e9a06">&#39;*/&#39;</span><span style="color:#000;font-weight:bold">)</span>  <span style="color:#8f5902;font-style:italic"># 返回匹配所有目录的迭代器</span>
</span></span></code></pre></div><h2 id="参考链接">参考链接</h2>
<ul>
<li><a href="https://rgb-24bit.github.io/blog/2018/glob.html">Glob 语法及解析</a></li>
</ul>
</div>



    
	
  



          </main>
        </div>
      </div>
      <footer class="td-footer row d-print-none">
  <div class="container-fluid">
    <div class="row mx-md-2">
      <div class="col-6 col-sm-4 text-xs-center order-sm-2">
        
        
        
      </div>
      <div class="col-6 col-sm-4 text-end text-xs-center order-sm-3">
        
        
        
<ul class="td-footer__links-list">
  
  <li class="td-footer__links-item" data-bs-toggle="tooltip" title="GitHub" aria-label="GitHub">
    <a target="_blank" rel="noopener" href="https://github.com/bwangelme/" aria-label="GitHub">
      <i class="fab fa-github"></i>
    </a>
  </li>
  
</ul>

        
        
      </div>
      <div class="td-footer__copyright-etc col-12 col-sm-4 text-center py-2 order-sm-2">
        <span>&copy; 2023 力行近乎仁，好问近乎智，知耻近乎勇 </span>
        <span class="ms-1"><a href="https://policies.google.com/privacy" target="_blank" rel="noopener"></a></span>
        
      </div>
    </div>
  </div>
</footer>
    </div>
    
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.css"
      integrity="sha512-mQwom8Ns4op+H29oDkD/LXO/OsXPvCFfkgZkFAVrhhePzRLU8NUI3Nkm43NhWUSmj3p5Cca2HTEkMQmXQRwDQQ==" crossorigin="anonymous">
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/katex.min.js"
        integrity="sha512-sHSNLECRJSK+BFs7E8DiFc6pf6n90bLI85Emiw1jhreduZhK3VXgq9l4kAt9eTIHYAcuQBKHL01QKs4/3Xgl8g=="
        crossorigin="anonymous">
</script>
  <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.4/dist/contrib/auto-render.min.js"
       integrity="sha512-iWiuBS5nt6r60fCz26Nd0Zqe0nbk1ZTIQbl3Kv7kYsX+yKMUFHzjaH2+AnM6vp2Xs+gNmaBAVWJjSmuPw76Efg==" crossorigin="anonymous"
       onload='renderMathInElement(document.body, null);'>
</script>
<script src="/647/js/main.min.6f5832c0d01e88c997eeb57e6b773ea3e1ac128fdf53739b3c750242f2355881.js" integrity="sha256-b1gywNAeiMmX7rV&#43;a3c&#43;o&#43;GsEo/fU3ObPHUCQvI1WIE=" crossorigin="anonymous"></script>
<script src='/647/js/prism.js'></script>
<script src='/647/js/tabpane-persist.js'></script>

  </body>
</html>
